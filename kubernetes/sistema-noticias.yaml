apiVersion: v1
kind: Pod
metadata:
  name: sistema-noticias
  labels:
    app: sistema-noticias
spec:
  nodeSelector:
    node: node1
  containers:
  - name: sistema-noticias-container
    image: aluracursos/sistema-noticias:1
    env:
      - name: "HOST_DB"
        valueFrom:
          configMapKeyRef:
            name: sistema-noticias-config
            key: HOST_DB

      - name: "USER_DB"
        valueFrom:
          configMapKeyRef:
            name: sistema-noticias-config
            key: USER_DB

      - name: "PASS_DB"
        valueFrom:
          configMapKeyRef:
            name: db-config
            key: MYSQL_PASSWORD
            
      - name: "DATABASE_DB"
        valueFrom:
          configMapKeyRef:
            name: db-config
            key: MYSQL_DATABASE      
    ports:
      - containerPort: 80 

---

apiVersion: v1
kind: Service
metadata:
  name: sistema-noticias-svc
spec:
  selector:
    app: sistema-noticias
  type: NodePort
  ports:
  - port: 80
    nodePort: 30011